<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../build/kagenda-styles.css">
  <style>
  body {
    font-size: 12px;
    font-family: "Helvetica Neue", sans-serif;
    line-height: 1.5;
  }
  *, *::after, *::before  {
    box-sizing: border-box;
  }
  a {
    color: #008CBA;
    text-decoration: none;
  }
  label.test {
    text-transform: uppercase;
    font-size: 10px;
    font-weight: bold;
    display: block;
  }
  </style>
</head>
<body>
  <form class="oauthClientID" onsubmit="onOAuthClientChange">
    <label class="test">Client ID</label>
    <input type="text" id="clientId">
    <button type="submit">Change</button>
  </form>
  <hr>

  <div class="ka"></div>

  <script>

  // This is just example code. Feel free to replace with your own way to load polyfill code.

  /*! loadJS: load a JS file asynchronously. [c]2014 @scottjehl, Filament Group, Inc. (Based on http://goo.gl/REQGQ by Paul Irish). Licensed MIT */
  function loadJS( src, cb ){
    "use strict";
    var ref = window.document.getElementsByTagName( "script" )[ 0 ];
    var script = window.document.createElement( "script" );
    script.src = src;
    script.async = true;
    ref.parentNode.insertBefore( script, ref );
    if (cb && typeof(cb) === "function") {
      script.onload = cb;
    }
    return script;
  }

  function onOAuthClientChange(e) {
    var clientId = document.getElementById('clientId').value;
    localStorage.setItem('test-client-id', clientId);
    e.preventDefault();
    window.location.reload();
  }

  function onLoad() {
    var clientId = localStorage.getItem('test-client-id');
    document.getElementById('clientId').value = clientId || '';
    console.log(clientId? `Client ID ${clientId} will be used to talk to the server` : 'Client ID not configured, the widget will be read-only');
    if (typeof Koliseo !== 'undefined' && Koliseo.agenda && typeof fetch !== 'undefined') {
      Koliseo.agenda.render({
        //c4pUrl: 'https://www.koliseo.com/codemotion/codemotion-madrid/r4p/5685252034920448',
        c4pUrl: './json/c4p.json',
        agendaUrl: './json/codemotion.json', // 'talks.json',
        element: document.querySelector('.ka'),
        oauthClientId: clientId
      })
    }
  }

  (typeof fetch === 'undefined') && loadJS('../build/koliseo-polyfill.js', onLoad)
  loadJS('../build/koliseo-agenda.js', onLoad)

  </script>
</body>
</html>
